---
name: jupiter
root: ~/sonian/jupiter
tmux_options: -2
socket_path: /tmp/sonian
pre: vagrant up
windows:
  - shell: git remote update
  - vm:
      layout: even-vertical
      panes:
        - htop: vagrant ssh -- -t 'cd /vagrant && htop'
        - logs: vagrant ssh -- -t 'tail -f jupiter.log & tail -f /var/log/elasticsearch/elasticsearch.log'
        - repl: vagrant ssh -- -t 'cd /vagrant && lein modules install && cd modules/test && bash -i -l -o vi -c "lein repl :start :host 0.0.0.0 :port 50000"'
        - shell: vagrant ssh -- -t 'cd /vagrant && bash -i -l -o vi'
  - editor: echo -n 'Vim waiting nREPL' && while ! nc -z 192.168.100.100 50000 &>/dev/null; do echo -n .; sleep 1; done; mvim -v -c 'Connect nrepl://192.168.100.100:50000' project.clj
  - tunnel: ssh -nvNT -R 9999:localhost:22 murilo@x.sa2s.us
  - socket_chmod: chmod 1777 /tmp/sonian && exit
